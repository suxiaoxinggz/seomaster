services:
  # ğŸ åç«¯ API æœåŠ¡
  backend:
    build:
      context: ./backend
    container_name: seo-backend
    restart: always
    environment:
      # ğŸ” æ•æ„Ÿä¿¡æ¯
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_SERVICE_KEY=${SUPABASE_SERVICE_KEY}
      - SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY}
      - DATAFORSEO_LOGIN=${DATAFORSEO_LOGIN}
      - DATAFORSEO_PASSWORD=${DATAFORSEO_PASSWORD}
      # R2 Storage
      - R2_ACCESS_KEY_ID=${R2_ACCESS_KEY_ID}
      - R2_SECRET_ACCESS_KEY=${R2_SECRET_ACCESS_KEY}
      - CLOUDFLARE_ACCOUNT_ID=${CLOUDFLARE_ACCOUNT_ID}
      - R2_BUCKET_NAME=${R2_BUCKET_NAME}
      # - OPENAI_API_KEY=${OPENAI_API_KEY}
    networks:
      - internal-net

  # ğŸŒ å‰ç«¯ Nginx + åå‘ä»£ç†
  frontend:
    build:
      context: .
      dockerfile: frontend.Dockerfile
      args:
        - VITE_SUPABASE_URL=${VITE_SUPABASE_URL}
        - VITE_SUPABASE_ANON_KEY=${VITE_SUPABASE_ANON_KEY}
    container_name: seo-frontend
    restart: always
    ports:
      # ğŸ›¡ï¸ å”¯ä¸€æš´éœ²ç«¯å£ï¼Œä»…é™æœ¬åœ°è®¿é—® (é…åˆ 1Panel åä»£)
      - "127.0.0.1:3060:80"
    depends_on:
      - backend
    networks:
      - internal-net

networks:
  internal-net:
    driver: bridge
