0. 先固定一张“数据流”认知图（给 AI 看）

请先让 AI 确认你系统是不是遵循这样的数据流（不一致就先说出来）：
	1.	关键词生成模块
	•	用户通过“关键词生成”得到一批 keywords，用户可以选择
	•	用户勾选 / 保存 → 写入 关键词库（DB + 存储）
	2.	文章生成模块
	•	从关键词库中选中若干关键词导入
	•	基于这些关键词生成 article
	•	文章生成后：文章 + 对应关键词 需要在前端展示，并持久化（DB + 存储）
	3.	图片生成模块
	•	从文章模块导入：article + 它关联的 keywords
	•	生成若干图片，与文章建立关联
	•	把“文章 + 图片 + 关键词关系”保存，并可以插入到文章内容里（HTML / Markdown）
	4.	待发布文章模块
	•	用户在“待发布文章”列表中能看到已经完成（带图 / 带关键词）的文章
	•	选择一个或多个 → 送入 Publishing 模块
	5.	Publishing 模块
	•	选择渠道（如：WordPress、Medium、自有站点等）
	•	把文章内容（含图片 URL、HTML、关键词/标签）发布到对应渠道
	•	回写发布结果（成功/失败、外部链接、错误信息等）

你可以先让 AI 编程助手回答一句：“当前代码是否严格遵守以上数据流？如否，请画出实际的数据流图。”

⸻

1. 数据模型 & 关联关系（全局检查点）

1.1 核心表/集合是否存在

让 AI 去找数据库定义（schema / migration / Prisma model / ORM model），确认至少有这些实体：
	•	Keyword（关键词库）
	•	Article（文章）
	•	Image 或类似图片表
	•	用于关联的表（可能名字类似）：
	•	ArticleKeyword
	•	ArticleImage
	•	PendingArticle 或 Article + status 字段（用于“待发布文章”）
	•	PublishingJob / PublishingTask（发布任务）

要 AI 回答的问题：

请列出项目里用于存储关键词、文章、图片、待发布文章、发布任务的所有数据表/集合（含字段），并画出它们之间的关联关系（用 ER 图或文字说明）。

⸻

1.2 ID 与关联是否贯穿全流程

检查点：
	1.	Keyword → Article
	•	是否在文章相关表中存储了 keyword_id / keyword_ids？
	•	是否存在 ArticleKeyword 这种多对多表？
	2.	Article → Image
	•	图片表内是否有 article_id 字段，或通过中间表关联？
	3.	Article → Pending/Publishing
	•	“待发布文章”这块，是：
	•	单独一个 PendingArticle 表引用了 article_id？
	•	还是 Article 本身有 status （例如：draft/generated/ready_to_publish/published）？

你可以这样让 AI 检查：

请在代码和数据库 schema 里检查：
	•	关键词与文章的关联是通过什么字段或中间表实现的？
	•	文章与图片的关联是通过什么字段或中间表实现的？
	•	待发布文章是否单独一张表？如果是，它如何引用 Article / Image / Keyword？

⸻

2. 关键词生成阶段（Keyword 模块）检查点

2.1 保存逻辑

要确认：
	1.	当用户在“关键词生成功能”里点击保存时，是否：
	•	在 Keyword 表插入记录
	•	同步写入任何对象存储（如果有，比如导出的 JSON/CSV）
	2.	关键词记录的核心字段是否齐全：

	•	id
	•	user_id
	•	keyword_text
	•	language / locale（如果有多语言）
	•	status（例如：raw/generated/used_in_article）
	•	created_at, updated_at

让 AI 检查：

请找到“关键词生成并保存”的后端处理代码，确认：
	1.	保存时写入的是哪张表/集合？字段有哪些？
	2.	是否存在与此对应的存储文件（如 JSON/CSV），对应路径/字段是什么？
	3.	保存失败时是否有错误处理和回滚？

2.2 供文章模块读取的接口
	•	是否有 API / service 方法用于按用户或按条件读取关键词库？
	•	返回数据是否包含 id，供后续 Article 模块使用？

让 AI 检查：

请找到“文章生成页面/接口”使用的关键词列表获取 API，检查：
	•	它是如何从数据库读取关键词的？
	•	返回的数据结构是否包含关键词的唯一 ID？

⸻

3. 文章生成阶段（Article 模块）检查点

3.1 从关键词库导入

检查：
	1.	前端选中的每个关键词，是否带有 keyword_id 传给后端？
	2.	后端生成文章时，是否将这些 keyword_id：
	•	直接存入 Article 的某个字段（如 keyword_ids JSON 数组），或
	•	写入中间表 ArticleKeyword(article_id, keyword_id)？

让 AI 检查：

请找到“文章生成”的后端接口：
	1.	入参中是否包含关键词 ID 列表？字段名是什么？
	2.	生成文章后，如何把关键词与文章关联（字段名/表名）？

3.2 文章内容的存储方式

要弄清楚：
	•	文章正文是存在 DB 里（如 Article.content_html / content_markdown / content_json），还是存为文件再存 URL？
	•	如果后面要插入图片，是改 DB 字段，还是改存储里的文件？

让 AI 检查：

请列出 Article 实体的字段，特别是用于存储正文内容和 HTML 的字段；
并说明正文是存储在数据库中还是对象存储中（例如 S3，返回 URL）。

3.3 前端展示“哪些关键词已经生成了文章”

需求：文章生成后，在文章列表 / 关键词列表中，让用户看到哪些关键词已经有文章。

检查点：
	1.	是否存在从 Keyword → Article 的查询：
	•	按 keyword_id 查询关联文章数量
	2.	接口是否为前端提供字段，如：
	•	Keyword.has_article
	•	或 Keyword.article_count

给 AI 的任务：

请检查当前后端是否提供：
	•	给前端获取“关键词 + 是否已生成文章”的接口；
	•	如果没有，请根据 Article 与 Keyword 的关系设计一个查询（含伪代码 / SQL）。

⸻

4. 图片生成阶段（Image 模块）检查点

你说这里是“导入文章和关键词，并且是关联关系”。需要确认：

4.1 入参是否带有 articleId + keywordIds
	•	图片生成接口是否接收：
	•	article_id
	•	keyword_ids / keyword_texts
	•	文章内容摘要（prompt）等

让 AI 检查：

请找到“图片生成”相关的后端接口，检查：
	1.	入参里是否有 article_id 和关联的关键词信息？
	2.	这些字段具体名是什么？

4.2 图片存储 & DB 结构
	•	图片文件本身存哪里？（如本地、S3、OSS）
	•	DB 中是否有 Image 表（或字段）记录：
	•	id
	•	article_id
	•	url / path
	•	prompt / keywords
	•	排序 / 用途（封面图、插图、缩略图等）

让 AI 检查：

请列出用于存储图片的表/集合及字段；
说明图片文件存储的位置（本地路径或对象存储 URL），以及图片与文章、关键词的关联方式。

4.3 “插入文章” 的更新逻辑
	•	图片生成后，如果插入到文章中：
	•	是否更新文章内容（HTML/Markdown），加入 <img> 标签或占位符？
	•	是否同步更新 Article 表里的字段（例如 has_images = true）？

给 AI 的问题：

当图片生成并“插入文章”时：
	•	哪一段代码负责修改文章内容？
	•	修改后的内容是如何保存（更新 DB 字段还是重写存储文件）？
	•	是否有事务或错误回滚逻辑（图片成功但文章更新失败时怎么办）？

⸻

5. 待发布文章 & Publishing 阶段检查点

你特别担心这里：“publishing 的数据库和存储有没有做好？还是说当前 Article 的数据库就能处理所有环节（图片、HTML、关键词）？”

5.1 “待发布文章” 的存储方式

有两种常见设计：
	1.	同一张 Article 表 + status 字段
	•	Article.status：draft/generated/with_image/ready_to_publish/published 等
	•	“待发布文章”页面就是查询 status = ready_to_publish
	2.	单独 PendingArticle 表
	•	PendingArticle 里引用 article_id
	•	可以支持“同一个文章多次发布到不同渠道”的情况

让 AI 检查：

请确认“待发布文章”功能是通过哪种数据结构实现的：
	1.	Article 表的 status 字段？
	2.	还是有单独的 PendingArticle / PublishQueue 表？
请列出相关字段，说明它们如何引用文章与图片。

5.2 Publishing 模块是否使用统一的 Article 数据
	•	发布时是否直接从 Article（+ 图片表）读取全部数据？
	•	是否有遗漏：例如发布接口只拿了纯文本，没拿 HTML / 图片 URL / 关键词？

让 AI 检查：

请找到 Publishing 模块（发布到各渠道的代码），检查：
	•	它从哪里读取文章内容？（Article 表还是别的存储）
	•	是否一并获取了图片信息和关键词信息？
	•	发布到外部渠道时，是否正确构造 HTML（含 <img>、标签/keywords）？

5.3 发布结果的回写
	•	发布成功后，是否更新：
	•	Article.status = published 或 PendingArticle 的状态
	•	PublishingJob 表中记录渠道、外部链接、发布时间
	•	发布失败时，是否记录错误信息，便于重试？

给 AI 的检查点：

请检查 Publishing 模块：
	1.	是否有 PublishingJob / PublishLog 之类的数据结构？字段有哪些？
	2.	发布成功/失败时分别会写入哪些字段？
	3.	Article 或 PendingArticle 的状态是否会被更新？

⸻

6. 总结：可以直接丢给 AI 编程助手的一组问题

你可以直接复制下面这些句子，一条条让 AI 去看代码和数据库：
	1.	请画出本项目中“关键词 → 文章 → 图片 → 待发布文章 → 发布”的实际数据流图，并列出涉及到的所有表/集合。
	2.	请列出用于存储关键词的表/集合及字段，并说明关键词是如何在“关键词生成”模块被保存的（含失败回滚逻辑）。
	3.	请说明文章生成接口的入参中，是否包含关键词的 ID 列表？文章生成后又是如何在数据库中与这些关键词建立关联的？
	4.	请列出 Article 相关表的字段（尤其是正文内容、HTML、关键词、图片相关字段），并说明正文是存数据库还是文件存储。
	5.	请确认系统是否提供给前端“关键词 + 是否已生成文章/文章数量”的接口，如果没有，请根据现有结构设计一个实现方案。
	6.	请找到图片生成接口，说明它接收哪些与文章和关键词相关的参数（article_id / keyword_ids / prompt 等），以及生成的图片是如何存储和关联文章的。
	7.	当用户选择“插入图片到文章”时，哪段代码负责更新文章内容？修改后的内容是如何持久化的？是否有事务保证图片和文章内容的一致性？
	8.	“待发布文章”是通过 Article 的 status 字段实现，还是单独有 PendingArticle / PublishQueue 表？请列出相关结构并说明它们与 Article、Image 的关系。
	9.	Publishing 模块在发布文章时，从哪些表/存储读取文章内容？是否包括图片 URL、HTML、关键词等全部信息？
	10.	发布成功和失败后，系统如何回写状态？分别会更新哪些表/字段，用于前端展示发布结果和后续重试？